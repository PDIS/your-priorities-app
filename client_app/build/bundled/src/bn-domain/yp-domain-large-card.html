<link rel="import" href="../../bower_components/polymer/polymer.html?v=8.0.0-4"><link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html?v=8.0.0-4"><link rel="import" href="../../bower_components/iron-image/iron-image.html?v=8.0.0-4"><link rel="import" href="../../bower_components/lite-signal/lite-signal.html?v=8.0.0-4"><link rel="import" href="../../bower_components/paper-menu-button/paper-menu-button.html?v=8.0.0-4"><link rel="import" href="../../bower_components/neon-animation/web-animations.html?v=8.0.0-4"><link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html?v=8.0.0-4"><link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html?v=8.0.0-4"><link rel="import" href="../../bower_components/neon-animation/web-animations.html?v=8.0.0-4"><link rel="import" href="../../bower_components/paper-material/paper-material.html?v=8.0.0-4"><link rel="import" href="../yp-app-globals/yp-app-icons.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-language-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-got-admin-rights-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/access-helpers.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-large-card-behaviors.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-media-formats-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-truncate-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-magic-text/yp-magic-text.html?v=8.0.0-4"><link rel="import" href="yp-domain-stats.html?v=8.0.0-4"><dom-module id="yp-domain-large-card"><template><style include="iron-flex iron-flex-alignment">.stats{position:absolute;bottom:0;right:8px}yp-domain-stats{color:#fff}.domain-name{padding:0;padding-bottom:4px;padding-right:1px;margin:0;min-height:54px;font-size:42px;font-weight:700}.large-card{background-color:#fefefe;color:#333;height:243px;width:432px;padding:0!important;margin-top:0!important}.image,video{width:432px;height:243px}.description-and-stats{width:100%}.edit{color:#FFF;position:absolute;top:0;left:384px;padding-right:0;margin-right:0}h1{font-size:42px}.textBox{margin-left:32px;position:relative}.description{padding:0;margin:0}.domainDescription{padding-left:16px;padding-right:16px;padding-top:16px}.domain-name{background-color:var(--primary-color-800,#000);color:#fafafa;padding:12px;padding-right:16px;padding-left:16px;vertical-align:middle;display:table-cell!important;margin:0;width:432px}@media (max-width:945px){:host{width:306px}.large-card{width:306px;height:100%}.top-card{margin-bottom:16px}.edit{left:265px}iron-image,video{width:306px!important;height:172px!important}.imageCard{height:172px!important}.domain-name{font-size:22px;padding-bottom:12px;min-height:28px}.description{padding-bottom:42px}.textBox{margin-left:0}}[hidden]{display:none!important}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout horizontal wrap"><paper-material id="cardImage" elevation="3" animated="" class="large-card imageCard top-card"><template is="dom-if" if="[[domainVideoURL]]" restamp=""><video id="videoPlayer" data-id$="[[domainVideoId]]" controls="" preload="meta" class="image" src="[[domainVideoURL]]" playsinline="" poster="[[domainVideoPosterURL]]"></video></template><template is="dom-if" if="[[!domainVideoURL]]"><iron-image class="image" hidden$="[[hideImage]]" sizing="cover" src$="[[_domainLogoImagePath(domain)]]"></iron-image></template></paper-material><paper-material id="card" elevation="4" animated="" class="large-card textBox"><div class="layout vertical"><div class="layout horizontal wrap"><div class="layout vertical description-and-stats"><div class="descriptionContainer"><div class="domain-name"><yp-magic-text text-type="domainName" content-language="[[domain.language]]" disable-translation="[[domain.configuration.disableNameAutoTranslation]]" text-only="" content="[[domain.name]]" content-id="[[domain.id]]"></yp-magic-text></div><template is="dom-if" if="[[domain.id]]"><yp-magic-text id="description" class="description domainDescription" text-type="domainContent" content-language="[[domain.language]]" content="[[domain.description]]" content-id="[[domain.id]]"></yp-magic-text></template></div></div></div><paper-menu-button vertical-align="top" horizontal-align="[[editMenuAlign]]" class="edit" hidden$="[[!showMenuItem]]"><paper-icon-button icon="more-vert" slot="dropdown-trigger"></paper-icon-button><paper-listbox slot="dropdown-content" on-iron-select="_menuSelection"><paper-item hidden$="[[!hasDomainAccess]]" id="editMenuItem">[[t('domain.edit')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="createOrganizationMenuItem">[[t('domain.createOrganization')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="pagesMenuItem">[[t('pages.managePages')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="usersMenuItem">[[t('domainUsers')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="adminsMenuItem">[[t('domainAdmins')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="organizationsGridMenuItem">[[t('organizationsAdmin')]]</paper-item><paper-item id="addCommunityMenuItem">[[t('community.add')]]</paper-item></paper-listbox></paper-menu-button></div><yp-domain-stats class="stats" domain="[[domain]]"></yp-domain-stats></paper-material></div><iron-media-query query="(max-width: 945px)" query-matches="{{narrowScreen}}"></iron-media-query><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal><lite-signal on-lite-signal-yp-pause-media-playback="_pauseMediaPlayback"></lite-signal></template><script>Polymer({is:"yp-domain-large-card",behaviors:[Polymer.ypLanguageBehavior,Polymer.LargeCardBehaviors,Polymer.AccessHelpers,Polymer.ypGotAdminRightsBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypTruncateBehavior],properties:{domain:{type:Object,notify:!0,value:null,observer:"_domainChanged"},elevation:{type:Number},hideImage:{type:Boolean,value:!1},hasDomainAccess:{type:Boolean,value:!1,computed:"_hasDomainAccess(domain, gotAdminRights)"},showMenuItem:{type:Boolean,value:!1,computed:"_showMenuItem(hasDomainAccess, domain)"},domainVideoURL:{type:String,computed:"_domainVideoURL(domain)"},domainVideoPosterURL:{type:String,computed:"_domainVideoPosterURL(domain)"},domainVideoId:Number},_domainChanged:function(i,e){this.setupMediaEventListeners(i,e)},_domainVideoURL:function(i){if(i&&i.configuration&&i.configuration.useVideoCover&&i.DomainLogoVideos){var e=this._getVideoURL(i.DomainLogoVideos);return e?(this.set("domainVideoId",i.DomainLogoVideos[0].id),e):null}return null},_domainVideoPosterURL:function(i){if(i&&i.configuration&&i.configuration.useVideoCover&&i.DomainLogoVideos){var e=this._getVideoPosterURL(i.DomainLogoVideos);return e||null}return null},_showMenuItem:function(i,e){return i||e&&!e.only_admins_can_create_communities},_hasDomainAccess:function(i,e){return!(!i||!e)&&null!=this.checkDomainAccess(i)},_menuSelection:function(i,e){"editMenuItem"==e.item.id?this._openEdit():"createOrganizationMenuItem"==e.item.id?this._newOrganization():"pagesMenuItem"==e.item.id?this._openPagesDialog():"organizationsGridMenuItem"==e.item.id?this._openOrganizationsGrid():"usersMenuItem"===e.item.id?this._openUsersDialog():"adminsMenuItem"===e.item.id?this._openAdminsDialog():"addCommunityMenuItem"==e.item.id&&this.fire("yp-new-community"),this.$$("paper-listbox").select(null)},_openUsersDialog:function(){window.appGlobals.activity("open","domainUsers"),Polymer.dom(document).querySelector("yp-app").getUsersGridAsync(function(i){i.setup(null,null,this.domain.id,!1),i.open(this.domain.name)}.bind(this))},_openAdminsDialog:function(){window.appGlobals.activity("open","domainAdmins"),Polymer.dom(document).querySelector("yp-app").getUsersGridAsync(function(i){i.setup(null,null,this.domain.id,!0),i.open(this.domain.name)}.bind(this))},_openOrganizationsGrid:function(){window.appGlobals.activity("open","domain.organizationsGrid"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("organizationsGrid",function(i){i.open()}.bind(this))},_openPagesDialog:function(){window.appGlobals.activity("open","domain.pagesAdmin"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("pagesGrid",function(i){i.setup(null,null,this.domain.id,!1),i.open()}.bind(this))},_openEdit:function(){window.appGlobals.activity("open","domainEdit"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("domainEdit",function(i){i.setup(this.domain,!1,this._refresh.bind(this)),i.open("edit",{domainId:this.domain.id})}.bind(this))},_newOrganization:function(){window.appGlobals.activity("open","organizationEdit"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("organizationEdit",function(i){i.setup(null,!0,this._refresh.bind(this)),i.open("new",{domainId:this.domain.id})}.bind(this))},_refresh:function(i){i&&this.set("domain",i),this.fire("update-domain")},_domainName:function(i){return i&&i.name?this.truncate(this.trim(i.name),200):i?i.short_name:void 0},_domainLogoImagePath:function(i){if(i)return this.getImageFormatUrl(i.DomainLogoImages,0)},_domainHeaderImagePath:function(i){if(i)return this.getImageFormatUrl(i.DomainHeaderImages,0)}});</script></dom-module>