<link rel="import" href="../../bower_components/polymer/polymer.html?v=8.0.0-4"><link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html?v=8.0.0-4"><link rel="import" href="../../bower_components/iron-image/iron-image.html?v=8.0.0-4"><link rel="import" href="../../bower_components/lite-signal/lite-signal.html?v=8.0.0-4"><link rel="import" href="../yp-app-globals/yp-app-icons.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-language-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/access-helpers.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-got-admin-rights-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-logged-in-user-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-media-formats-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-truncate-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-behaviors/yp-goto-behavior.html?v=8.0.0-4"><link rel="import" href="../yp-magic-text/yp-magic-text.html?v=8.0.0-4"><link rel="import" href="yp-post-actions.html?v=8.0.0-4"><link rel="import" href="yp-post-cover-media.html?v=8.0.0-4"><link rel="import" href="yp-post-behaviors.html?v=8.0.0-4"><dom-module id="yp-post-card"><template><style include="iron-flex iron-flex-alignment">.post-name{margin:0;font-size:var(--extra-large-heading-size,28px);background-color:var(--primary-color-600);color:#FFF;height:50px;padding:14px;cursor:pointer;vertical-align:middle!important;display:table-cell!important;width:416px;font-weight:700}.postNameContainer{width:100%}.postCardCursor{cursor:pointer}.postCard{background-color:#fff;@apply --layout-horizontal;}:host{display:block;@apply --layout-vertical;}.postCard{height:435px;width:416px}.postCard[hide-post-cover]{height:190px}.postCard[hide-post-cover][hide-actions]{height:165px}.postCard[hide-post-cover][hide-description]{height:140px}.postCard[hide-description]{height:372px}.postCard[hide-description][hide-actions]{height:311px}.postCard[hide-description][hide-post-cover][hide-actions]{height:77px}.postCard[hide-actions]{height:402px}.postCard[mini]{width:210px;height:100%;margin:0;padding-top:0}yp-post-cover-media{width:416px;height:234px}yp-post-cover-media[mini]{width:210px;height:118px;min-height:118px}.post-name{font-size:23px}.post-name[mini]{padding:16px}.description{font-size:18px;padding:8px;cursor:pointer}.postActions{position:absolute;right:24px;bottom:16px}@media (max-width:420px){.postCard{margin-left:0;margin-right:0;padding-left:0;padding-right:0;width:304px}.postCard[hide-post-cover]{height:230px}.postCard[hide-description]{height:302px}.postCard[hide-description][hide-post-cover]{height:134px}.postCard[hide-post-cover][hide-actions]{height:180px}.postCard[hide-description][hide-actions]{height:240px}.postCard[hide-description][hide-post-cover][hide-actions]{height:77px}.postCard[hide-actions]{height:402px}.postCard[mini]{width:210px;height:100%}.card{margin-left:0;margin-right:0;padding-left:0;padding-right:0;width:304px;height:400px}.card[mini]{width:210px;height:100%}.postActions{bottom:0;right:8px}yp-post-cover-media{width:304px;height:171px}yp-post-cover-media[mini]{width:210px;height:118px;min-height:118px}}[hidden]{display:none!important}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-logged-in="_userLoggedIn"></lite-signal><iron-media-query query="(min-width: 600px)" query-matches="{{wide}}"></iron-media-query><paper-material mini$="[[mini]]" hide-post-cover$="[[post.Group.configuration.hidePostCover]]" hide-description$="[[post.Group.configuration.hidePostDescription]]" hide-actions$="[[post.Group.configuration.hidePostActionsInGrid]]" class="card postCard layout vertical" elevation="[[elevation]]" animated=""><div class="layout vertical"><yp-post-cover-media mini$="[[mini]]" post="[[post]]" hidden$="[[post.Group.configuration.hidePostCover]]"></yp-post-cover-media><div class="postNameContainer"><div class="post-name" mini$="[[mini]]" id="postName" on-tap="goToPostIfNotHeader"><yp-magic-text id="postNameMagicText" text-type="postName" content-language="[[post.language]]" text-only="" content="[[postName]]" content-id="[[post.id]]"></yp-magic-text></div></div><yp-magic-text class="description layout horizontal" on-tap="goToPostIfNotHeader" hidden$="[[hideDescription]]" text-type="postContent" content-language="[[post.language]]" text-only="" content="[[post.description]]" content-id="[[post.id]]" truncate="100"></yp-magic-text><div hidden$="[[post.Group.configuration.hidePostActionsInGrid]]"><yp-post-actions floating="" class="postActions" elevation="-1" endorse-mode="[[endorseMode]]" post="[[post]]" hidden$="[[mini]]"></yp-post-actions></div></div></paper-material></template><script>Polymer({is:"yp-post-card",behaviors:[Polymer.ypLanguageBehavior,Polymer.YpPostBehavior,Polymer.AccessHelpers,Polymer.ypLoggedInUserBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypTruncateBehavior,Polymer.ypGotoBehavior],properties:{hideDescription:{type:Boolean,computed:"_hideDescription(mini, post)"},selectedMenuItem:{type:String},elevation:{type:Number,value:2},post:{type:Object,observer:"_postChanged"},hasPostAccess:{type:Boolean,value:!1,notify:!0,computed:"_hasPostAccess(post, gotAdminRights)"},mini:{type:Boolean,value:!1}},_hideDescription:function(e,t){return e||t&&t.Group.configuration&&t.Group.configuration.hidePostDescription},_hasPostAccess:function(e,t){return!(!e||!t)&&null!=this.checkPostAccess(e)},goToPostIfNotHeader:function(){this.post.Group.configuration&&this.post.Group.configuration.disablePostPageLink?console.log("goToPostDisabled"):this.goToPost()},_postChanged:function(e){e&&this.async(function(){var t=this.$$("#postName");t&&(this.mini?e.name.length>200?t.style.fontSize="12px":e.name.length>100?t.style.fontSize="13px":e.name.length>40?t.style.fontSize="16px":e.name.length>20?t.style.fontSize="18px":t.style.fontSize="19px":this.wide?e.name.length>200?t.style.fontSize="15px":e.name.length>100?t.style.fontSize="18px":e.name.length>40?t.style.fontSize="19px":e.name.length>20?t.style.fontSize="22px":t.style.fontSize="24px":e.name.length>200?t.style.fontSize="13px":e.name.length>100?t.style.fontSize="15px":e.name.length>40?t.style.fontSize="16px":e.name.length>20?t.style.fontSize="21px":t.style.fontSize="22px")})},updateDescriptionIfEmpty:function(e){this.post.description&&""!=this.post.description||this.set("post.description",e)},_refresh:function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("postEdit",function(e){e.selected=0,this.fire("refresh")}.bind(this))},_openReport:function(){window.appGlobals.activity("open","post.report"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("apiActionDialog",function(e){e.setup("/api/posts/"+this.post.id+"/report",this.t("reportConfirmation"),this._onReport.bind(this),this.t("post.report"),"PUT"),e.open()}.bind(this))},_onReport:function(){window.appGlobals.notifyUserViaToast(this.t("post.report")+": "+this.post.name)}});</script></dom-module>