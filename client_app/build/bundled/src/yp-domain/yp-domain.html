<div hidden="" by-polymer-bundler=""><dom-module id="yp-community-card" assetpath="../yp-community/"><template><style include="iron-flex iron-flex-alignment">:host{@apply --layout-vertical;}.description{@apply --layout-vertical;color:var(--primary-color-more-darker,#424242);line-height:var(--description-line-height,1.3);padding:8px;margin-top:4px}.stats{color:var(--primary-color-more-darker,#424242);position:absolute;bottom:0;right:8px}.post-image{width:100%}.communityCard{height:395px;width:320px;background-color:#fff;padding:0;margin:0}iron-image{width:320px;height:180px}.card-content{padding:0;padding-bottom:48px}iron-image{padding:0;margin:0}iron-image{padding:0;margin:0}paper-card{background-color:red;vertical-align:text-top}.informationText{vertical-align:text-top}.community-name{font-size:26px;height:42px;padding:14px;background-color:var(--primary-color-800);color:#FFF;cursor:pointer;vertical-align:middle;display:table-cell;width:320px}yp-membership-button{position:absolute;top:159px;right:18px;width:30px;height:30px;color:var(--icon-general-color,#FFF)}.community-name[featured]{background-color:var(--accent-color)}.community-name[archived]{background-color:#aaa}yp-membership-button[archived]{display:none}@media (max-width:480px){:host{width:304px}yp-membership-button{top:146px}.communityCard{margin-right:8px;height:430px;padding-left:0;padding-right:0;width:304px}iron-image{width:304px;height:165px}.description{margin-bottom:32px}}@media (max-width:680px){.communityCard[featured]{width:304px}.secondImage{display:none}}.withPointer{cursor:pointer}[hidden]{display:none!important}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><template is="dom-if" if="[[community]]"><paper-card featured$="[[featured]]" class="communityCard" animated="" elevation="[[elevation]]"><div class="layout horizontal"><template is="dom-if" if="[[noImage]]"><iron-image header-mode$="[[headerMode]]" archived$="[[archived]]" sizing="cover" class="main-image withPointer" src="https://i.imgur.com/sdsFAoT.png" on-tap="_goToCommunity"></iron-image></template><template is="dom-if" if="[[!noImage]]"><iron-image sizing="cover" archived$="[[archived]]" featured$="[[featured]]" preload="" src="[[communityLogoImagePath]]" class="post-image withPointer" on-tap="_goToCommunity"></iron-image></template></div><div class="informationText"><div class="community-name" archived$="[[archived]]" featured$="[[featured]]" on-tap="_goToCommunity"><yp-magic-text text-type="communityName" content-language="[[community.language]]" disable-translation="[[community.configuration.disableNameAutoTranslation]]" text-only="" content="[[communityName]]" content-id="[[community.id]]"></yp-magic-text><span hidden="" old-hidden$="[[!archived]]">- [[t('archived')]]</span></div><yp-magic-text id="description" class="description withPointer" featured$="[[featured]]" on-tap="_goToCommunity" text-type="communityContent" content-language="[[community.language]]" text-only="" content="[[communityDescription]]" content-id="[[community.id]]" truncate="130"></yp-magic-text></div><yp-community-stats class="stats" community="[[community]]"></yp-community-stats><yp-membership-button archived$="[[archived]]" featured$="[[featured]]" community="[[community]]"></yp-membership-button></paper-card></template></template><script>Polymer({is:"yp-community-card",behaviors:[Polymer.ypLanguageBehavior,Polymer.CommunityBehaviors,Polymer.ypTruncateBehavior,Polymer.ypImageFormatsBehavior,Polymer.ypGotoBehavior],properties:{}});</script></dom-module><dom-module id="yp-community-grid" assetpath="../yp-community/"><template><style include="iron-flex iron-flex-alignment">.card[wide]{padding:16px}.card{padding:0;padding-top:16px}.archivedText{font-size:25px;color:#333}.archivedBorder{border-bottom:1px solid;width:95%;margin-bottom:12px;border-color:#444}[hidden]{display:none!important}:focus{outline:0}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(min-width: 600px)" query-matches="{{wide}}"></iron-media-query><iron-list id="ironList" scroll-offset="350" items="[[activeCommunities]]" as="community" scroll-target="document" grid=""><template><yp-community-card tabindex$="[[tabIndex]]" wide$="[[wide]]" class="card" community="[[community]]" on-mouseover="cardMouseOver" on-mouseout="cardMouseOut"></yp-community-card></template></iron-list></template><script>Polymer({is:"yp-community-grid",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypIronListBehavior,Polymer.ypCardMouseBehavior],properties:{featuredCommunities:Array,archivedCommunities:Array,activeCommunities:Array,hideAdd:{type:Boolean,value:!1}},_newCommunity:function(){this.fire("add-new-community")}});</script></dom-module><dom-module id="yp-domain-stats"><template><style include="iron-flex iron-flex-alignment">:host{display:block}.stats{padding-top:8px;padding-bottom:8px;color:var(--main-stats-color-on-white)}.stats-text{font-size:18px;text-align:right;vertical-align:bottom;padding-right:8px;color:var(--main-stats-color-on-white)}.stats-icon{padding-left:8px;margin-right:4px}@media (max-width:945px){.hideIfMobile{display:none}}[hidden]{display:none!important}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(max-width: 800px)" query-matches="{{narrowScreen}}"></iron-media-query><div class="stats layout horizontal end-justified"><div class="layout horizontal wrap"><div class="layout horizontal"><iron-icon title$="[[t('stats.posts')]]" icon="lightbulb-outline" class="stats-icon"></iron-icon><div title$="[[t('stats.posts')]]" class="stats-text" style="">{{formatNumber(domain.counter_posts)}}</div><iron-icon title$="[[t('stats.discussions')]]" icon="chat-bubble-outline" class="stats-icon"></iron-icon><div title$="[[t('stats.discussions')]]" class="stats-text">{{formatNumber(domain.counter_points)}}</div><iron-icon hidden$="[[narrowScreen]]" title$="[[t('stats.communities')]]" icon="group-work" class="stats-icon hideIfMobile"></iron-icon><div hidden$="[[narrowScreen]]" title$="[[t('stats.communities')]]" class="stats-text hideIfMobile" style="">{{formatNumber(domain.counter_communities)}}</div></div><div class="layout horizontal"><iron-icon hidden="" title$="[[t('stats.groups')]]" icon="people" class="stats-icon hideIfMobile"></iron-icon><div hidden="" title$="[[t('stats.groups')]]" class="stats-text hideIfMobile" style="">{{formatNumber(domain.counter_groups)}}</div><iron-icon title$="[[t('stats.users')]]" icon="face" class="stats-icon"></iron-icon><div title$="[[t('stats.users')]]" class="stats-text">{{formatNumber(domain.counter_users)}}</div></div></div></div></template><script>Polymer({is:"yp-domain-stats",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypNumberFormatBehavior],properties:{domain:{type:Object},narrowScreen:Boolean}});</script></dom-module><dom-module id="yp-domain-large-card"><template><style include="iron-flex iron-flex-alignment">.stats{position:absolute;bottom:0;right:8px}yp-domain-stats{color:#fff}.domain-name{padding:0;padding-bottom:4px;padding-right:1px;margin:0;min-height:54px;font-size:42px;font-weight:700}.large-card{background-color:#fefefe;color:#333;height:243px;width:432px;padding:0!important;margin-top:0!important}.image,video{width:432px;height:243px}.description-and-stats{width:100%}.edit{color:#FFF;position:absolute;top:0;left:384px;padding-right:0;margin-right:0}h1{font-size:42px}.textBox{margin-left:32px;position:relative}.description{padding:0;margin:0}.domainDescription{padding-left:16px;padding-right:16px;padding-top:16px}.domain-name{background-color:var(--primary-color-800,#000);color:#fafafa;padding:12px;padding-right:16px;padding-left:16px;vertical-align:middle;display:table-cell!important;margin:0;width:432px}@media (max-width:945px){:host{width:306px}.large-card{width:306px;height:100%}.top-card{margin-bottom:16px}.edit{left:265px}iron-image,video{width:306px;height:172px!important}.imageCard{height:172px!important}.domain-name{font-size:22px;padding-bottom:12px;min-height:28px}.description{padding-bottom:42px}.textBox{margin-left:0}}[hidden]{display:none!important}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout horizontal wrap"><paper-material id="cardImage" elevation="3" animated="" class="large-card imageCard top-card"><template is="dom-if" if="[[domainVideoURL]]" restamp=""><video id="videoPlayer" controls="" class="image" src="[[domainVideoURL]]"></video></template><template is="dom-if" if="[[!domainVideoURL]]"><iron-image class="image" hidden$="[[hideImage]]" sizing="cover" src$="[[_domainLogoImagePath(domain)]]"></iron-image></template></paper-material><paper-material id="card" elevation="4" animated="" class="large-card textBox"><div class="layout vertical"><div class="layout horizontal wrap"><div class="layout vertical description-and-stats"><div class="descriptionContainer"><div class="domain-name"><yp-magic-text text-type="domainName" content-language="[[domain.language]]" disable-translation="[[domain.configuration.disableNameAutoTranslation]]" text-only="" content="[[domain.name]]" content-id="[[domain.id]]"></yp-magic-text></div><template is="dom-if" if="[[domain.id]]"><yp-magic-text id="description" class="description domainDescription" text-type="domainContent" content-language="[[domain.language]]" content="[[domain.description]]" content-id="[[domain.id]]"></yp-magic-text></template></div></div></div><paper-menu-button vertical-align="top" horizontal-align="[[editMenuAlign]]" class="edit" hidden$="[[!showMenuItem]]"><paper-icon-button icon="more-vert" slot="dropdown-trigger"></paper-icon-button><paper-listbox slot="dropdown-content" on-iron-select="_menuSelection"><paper-item hidden$="[[!hasDomainAccess]]" id="editMenuItem">[[t('domain.edit')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="createOrganizationMenuItem">[[t('domain.createOrganization')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="pagesMenuItem">[[t('pages.managePages')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="usersMenuItem">[[t('domainUsers')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="adminsMenuItem">[[t('domainAdmins')]]</paper-item><paper-item hidden$="[[!hasDomainAccess]]" id="organizationsGridMenuItem">[[t('organizationsAdmin')]]</paper-item><paper-item id="addCommunityMenuItem">[[t('community.add')]]</paper-item></paper-listbox></paper-menu-button></div><yp-domain-stats class="stats" domain="[[domain]]"></yp-domain-stats></paper-material></div><iron-media-query query="(max-width: 945px)" query-matches="{{narrowScreen}}"></iron-media-query><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal><lite-signal on-lite-signal-yp-pause-video="_pauseVideo"></lite-signal></template><script>Polymer({is:"yp-domain-large-card",behaviors:[Polymer.ypLanguageBehavior,Polymer.LargeCardBehaviors,Polymer.AccessHelpers,Polymer.ypGotAdminRightsBehavior,Polymer.ypImageFormatsBehavior,Polymer.ypTruncateBehavior],properties:{domain:{type:Object,notify:!0,value:null},elevation:{type:Number},hideImage:{type:Boolean,value:!1},hasDomainAccess:{type:Boolean,value:!1,computed:"_hasDomainAccess(domain, gotAdminRights)"},showMenuItem:{type:Boolean,value:!1,computed:"_showMenuItem(hasDomainAccess, domain)"},domainVideoURL:{type:String,computed:"_domainVideoURL(domain)"}},_pauseVideo:function(){var i=this.$$("#videoPlayer");i&&i.pause()},_domainVideoURL:function(i){return i&&i.configuration.useVideoCover&&i.DomainLogoVideos&&i.DomainLogoVideos.length>0&&i.DomainLogoVideos[0].viewable?i.DomainLogoVideos[0].formats[0]:null},_showMenuItem:function(i,e){return i||e&&!e.only_admins_can_create_communities},_hasDomainAccess:function(i,e){return!(!i||!e)&&null!=this.checkDomainAccess(i)},_menuSelection:function(i,e){"editMenuItem"==e.item.id?this._openEdit():"createOrganizationMenuItem"==e.item.id?this._newOrganization():"pagesMenuItem"==e.item.id?this._openPagesDialog():"organizationsGridMenuItem"==e.item.id?this._openOrganizationsGrid():"usersMenuItem"===e.item.id?this._openUsersDialog():"adminsMenuItem"===e.item.id?this._openAdminsDialog():"addCommunityMenuItem"==e.item.id&&this.fire("yp-new-community"),this.$$("paper-listbox").select(null)},_openUsersDialog:function(){window.appGlobals.activity("open","domainUsers"),Polymer.dom(document).querySelector("yp-app").getUsersGridAsync(function(i){i.setup(null,null,this.domain.id,!1),i.open(this.domain.name)}.bind(this))},_openAdminsDialog:function(){window.appGlobals.activity("open","domainAdmins"),Polymer.dom(document).querySelector("yp-app").getUsersGridAsync(function(i){i.setup(null,null,this.domain.id,!0),i.open(this.domain.name)}.bind(this))},_openOrganizationsGrid:function(){window.appGlobals.activity("open","domain.organizationsGrid"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("organizationsGrid",function(i){i.open()}.bind(this))},_openPagesDialog:function(){window.appGlobals.activity("open","domain.pagesAdmin"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("pagesGrid",function(i){i.setup(null,null,this.domain.id,!1),i.open()}.bind(this))},_openEdit:function(){window.appGlobals.activity("open","domainEdit"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("domainEdit",function(i){i.setup(this.domain,!1,this._refresh.bind(this)),i.open("edit",{domainId:this.domain.id})}.bind(this))},_newOrganization:function(){window.appGlobals.activity("open","organizationEdit"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("organizationEdit",function(i){i.setup(null,!0,this._refresh.bind(this)),i.open("new",{domainId:this.domain.id})}.bind(this))},_refresh:function(i){i&&this.set("domain",i),this.fire("update-domain")},_domainName:function(i){return i&&i.name?this.truncate(this.trim(i.name),200):i?i.short_name:void 0},_domainLogoImagePath:function(i){if(i)return this.getImageFormatUrl(i.DomainLogoImages,0)},_domainHeaderImagePath:function(i){if(i)return this.getImageFormatUrl(i.DomainHeaderImages,0)}});</script></dom-module></div><dom-module id="yp-domain"><template><style include="iron-flex iron-flex-alignment">ac-activities{@apply --layout-vertical;@apply --layout-flex;}.card-container{@apply --layout-horizontal;@apply --layout-wrap;}.card{padding:16px}@media (max-width:330px){.card{padding-left:0;padding-right:0;padding-bottom:8px;padding-top:8px}.card-container{padding:0;margin:0}}yp-ajax{background-color:var(--primary-background-color)}.twitterFeed{margin-top:24px}.archivedText{font-size:26px;color:#333}.ypBottomContainer{@apply --layout-horizontal;@apply --layout-center-center;}:host{display:block}.minHeightSection{min-height:450px}#paper_tabs[apple]{margin-top:42px;margin-bottom:8px}</style><yp-page id="page" create-fab-icon="[[createFabIcon]]" create-fab-title="[[t('community.add')]]" on-yp-create-fab-tap="_newCommunity"><yp-domain-large-card id="domainCard" slot="largeCard" class="largeCard card" domain="[[domain]]" on-update-domain="_refreshAjax"></yp-domain-large-card><paper-tabs id="paper_tabs" apple$="[[isOldiOs]]" slot="tabs" class="tabs" selected="{{selectedTab}}" attr-for-selected="name" focused=""><paper-tab name="communities" class="tab"><span>[[t('communities')]]</span> &nbsp; (<span>[[communitiesLength]]</span>)</paper-tab><paper-tab name="news" class="tab">[[t('news')]]</paper-tab></paper-tabs><iron-pages class="tabPages" fullbleed="" slot="tabPages" selected="{{selectedTab}}" attr-for-selected="name" entry-animation="fade-in-animation" exit-animation="fade-out-animation"><section name="communities" class="layout vertical"><div class="card-container layout center-center wrap"><yp-community-grid featured-communities="[[featuredCommunities]]" active-communities="[[activeCommunities]]" archived-communities="[[archivedCommunities]]" hide-add$="[[!createFabIcon]]" on-add-new-community="_newCommunity"></yp-community-grid></div></section><section name="news" class="minHeightSection"><template is="dom-if" if="[[newsTabSelected]]"><ac-activities id="domainNews" selected-tab="[[selectedTab]]" domain-id="[[domain.id]]"></ac-activities></template></section></iron-pages></yp-page><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-logged-in="_userLoggedIn"></lite-signal><app-route route="{{idRoute}}" pattern="/:id" data="{{idRouteData}}" tail="{{tabRoute}}"></app-route><app-route route="{{tabRoute}}" pattern="/:tabName" data="{{tabRouteData}}"></app-route><div class="ypBottomContainer"><yp-ajax id="ajax" url="[[url]]" on-response="_response"></yp-ajax><yp-ajax id="pagesAjax" on-response="_pagesResponse"></yp-ajax></div></template><script>Polymer({is:"yp-domain",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypThemeBehavior,Polymer.CommunityCollectionBehaviors,Polymer.CollectionHelpers,Polymer.AccessHelpers,Polymer.YpNewsTabSelected,Polymer.ypLoggedInUserBehavior,Polymer.ypDetectOldiOs,Polymer.ypGotoBehavior],properties:{idRoute:Object,tabRoute:Object,idRouteData:Object,tabRouteData:Object,createFabIcon:{type:String,value:null,notify:!0},domainId:{type:Number,value:null,observer:"_domainIdChanged"},url:{type:String},domainEmpty:{type:Boolean,value:!1},domain:{type:Object},selectedTab:{type:String,value:"communities",observer:"_selectedTabChanged"},otherSocialMediaActive:{type:Boolean,value:!1},isOldiOs:{type:Boolean,computed:"_isOldiOs(domainId)"}},observers:["_routeIdChanged(idRouteData.id)","_routeTabChanged(tabRouteData.tabName)"],listeners:{"yp-new-community":"_newCommunity"},_userLoggedIn:function(e){e&&this.domain&&window.location.href.indexOf("/domain/")>-1&&this.$.ajax.generateRequest()},_routeIdChanged:function(e){e&&this.set("domainId",e)},_routeTabChanged:function(e){e&&this.set("selectedTab",e)},_selectedTabChanged:function(e){"other_social_media"==e?this.set("otherSocialMediaActive",!0):this.set("otherSocialMediaActive",!1),this.domain&&this.redirectTo("/domain/"+this.domain.id+"/"+e),e&&window.appGlobals&&window.appGlobals.activity("open","domain_tab_"+e),this.async(function(){var e=this.$$("#domainNews");e&&e.fireResize()},300)},_domainIdChanged:function(e,i){e&&(this.set("featuredCommunities",null),this.set("activeCommunities",null),this.set("archivedCommunities",null),this.$.ajax.url="/api/domains/"+this.domainId,this.$.ajax.generateRequest())},_refreshAjax:function(){this.$.ajax.generateRequest()},_newCommunity:function(){window.appGlobals.activity("open","newCommunity"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("communityEdit",function(e){e.setup(null,!0,this._refreshAjax.bind(this)),e.open("new",{domainId:this.domainId})}.bind(this))},_pagesResponse:function(e,i){this.fire("yp-set-pages",i.response)},_response:function(e,i,t){console.log("Got domain response: "+i.response.id),this.set("domain",i.response),window.appGlobals.domain=this.domain,this.refresh(),this.domain.only_admins_can_create_communities&&!this.checkDomainAccess(this.domain)||this.set("createFabIcon","group-work"),window.appGlobals.setupGoogleAnalytics(this.domain),this.domain.Communities&&this.setupCommunities(__.dropRight(this.domain.Communities,this.domain.Communities.length-500)),this.$.domainCard.setElevation(5),this.$.domainCard.lowerCardLater()},refresh:function(){this.domain&&(null!=this.domain.default_locale&&window.appGlobals.changeLocaleIfNeeded(this.domain.default_locale),null!=this.domain.theme_id&&this.setTheme(this.domain.theme_id),this.fire("yp-set-home-link",{type:"domain",id:this.domain.id,name:this.domain.name}),this.fire("change-header",{headerTitle:null,documentTitle:this.domain.name,headerDescription:this.domain.description}),this.domain.DomainHeaderImages&&this.domain.DomainHeaderImages.length>0?this.$.page.setupTopHeaderImage(this.domain.DomainHeaderImages):this.$.page.setupTopHeaderImage(null),this.$.pagesAjax.url="/api/domains/"+this.domain.id+"/pages",this.$.pagesAjax.generateRequest()),window.appGlobals.setAnonymousGroupStatus(null),window.appGlobals.disableFacebookLoginForGroup=!1,window.appGlobals.externalGoalTriggerUrl=null,window.appGlobals.currentGroupForceSaml=!1}});</script></dom-module>