<div hidden="" by-polymer-bundler=""><script>!function(){"use strict";Polymer({is:"google-map-search",properties:{map:{type:Object,value:null},query:{type:String,value:null},latitude:{type:Number,value:null},longitude:{type:Number,value:null},radius:{type:Number,value:null},globalSearch:{type:Boolean,value:!1},types:{type:String,value:null},results:{type:Array,value:function(){return[]},notify:!0},location:{type:Object,value:null,readOnly:!0}},observers:["search(query,map,location,radius,types,globalSearch)","_updateLocation(latitude,longitude)"],search:function(){if(this.query&&this.map){var t=new google.maps.places.PlacesService(this.map);if(this.types&&"string"==typeof this.types)var e=this.types.split(" ");if(this.radius)var i=this.radius,s=this.location?this.location:this.map.getCenter();else if(!this.globalSearch)var a=this.map.getBounds();t.textSearch({query:this.query,types:e,bounds:a,radius:i,location:s},this._gotResults.bind(this))}},getDetails:function(t){var e=new google.maps.places.PlacesService(this.map);return new Promise(function(i,s){e.getDetails({placeId:t},function(t,e){e===google.maps.places.PlacesServiceStatus.OK?(i(t),this.fire("google-map-search-place-detail",t)):s(e)}.bind(this))}.bind(this))},_gotResults:function(t,e){this.results=t.map(function(t){return t.latitude=t.geometry.location.lat(),t.longitude=t.geometry.location.lng(),t}),this.fire("google-map-search-results",this.results)},_updateLocation:function(){if(this.map){if("number"!=typeof this.latitude||isNaN(this.latitude))throw new TypeError("latitude must be a number");if("number"!=typeof this.longitude||isNaN(this.longitude))throw new TypeError("longitude must be a number");this._setLocation({lat:this.latitude,lng:this.longitude})}}})}();</script><dom-module id="yp-post-location" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">:host{display:block;width:100%;height:100%}.location-button{@apply --layout-horizontal;@apply --layout-flex;}#map{width:100%;height:100%}@media screen and (-ms-high-contrast:active),(-ms-high-contrast:none){#map{min-height:220px}}.mapSearchInput{width:100%;margin-top:8px}paper-input{width:250px}.searchResultText{width:100%;text-align:right;padding-top:8px}paper-button{font-size:16px;padding-top:32px}@media (max-width:390px){#map{max-height:180px}}@media (max-width:320px){#map{max-height:160px}}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(max-width: 1024px)" query-matches="{{narrowPad}}"></iron-media-query><google-map-search id="mapSearch" map="[[map]]" on-google-map-search-results="_mapSearchResults"></google-map-search><google-map additional-map-options="{&quot;keyboardShortcuts&quot;:false}" id="map" zoom="[[mapZoom]]" api-key="AIzaSyDkF_kak8BVZA5zfp5R4xRnrX8HP3hjiL0" map="{{map}}" libraries="places" on-map-type-changed="_mapTypeChanged" class="map" click-events="" on-zoom-changed="_zoomChanged" on-google-map-click="_setLocation" fit-to-markers=""><google-map-marker slot="markers" latitude="[[defaultLatitude]]" longitude="[[defaultLongitude]]" id="marker"></google-map-marker></google-map><div class="mapSearchInput layout vertical center-center"><div class="layout horizontal center-center wrap"><paper-input max-length="60" label="[[t('maps.searchInput')]]" value="{{mapSearchString}}" on-keydown="_submitOnEnter"></paper-input><paper-button on-tap="_searchMap">[[t('maps.search')]]</paper-button></div><div class="searchResultText layout horizontal center-center">[[mapSearchResultAddress]]</div><paper-spinner id="spinner"></paper-spinner></div></template><script>Polymer({is:"yp-post-location",behaviors:[Polymer.ypLanguageBehavior],properties:{map:{type:Object},group:{type:Object,observer:"_groupChanged"},defaultLatitude:{type:String,value:"64.13897027178841"},defaultLongitude:{type:String,value:"-21.876912117004395"},mapSearchString:{type:String,value:""},mapSearchResultAddress:{type:String,value:""},location:{type:Object,observer:"_locationChanged",notify:!0},mapZoom:{type:Number,value:13,computed:"_computeMapZoom(location)"},encodedLocation:{type:String,notify:!0},post:{type:Object,observer:"_postChanged"},marker:{type:Object},active:{type:Boolean,value:!1},narrowPad:Boolean},_computeMapZoom:function(t){return t&&t.map_zoom?t.map_zoom:this.mapZoom},_submitOnEnter:function(t){13===t.keyCode&&this._searchMap()},_searchMap:function(){this.$.mapSearch.query=this.mapSearchString,this.$.mapSearch.search(),this.$.spinner.active=!0,this.set("mapSearchResultAddress","")},_mapSearchResults:function(t,o){this.$.spinner.active=!1,o&&o.length>0&&(this.set("location",{latitude:o[0].latitude,longitude:o[0].longitude,map_zoom:15}),this.mapSearchResultAddress=o[0].formatted_address,this.$.map.zoom=15,this.$.map.resize())},ready:function(){this.location||this.async(function(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(t){this.location||(this.location={latitude:t.coords.latitude,longitude:t.coords.longitude,map_zoom:13})}.bind(this))},50)},_zoomChanged:function(t,o){o&&o.value&&this.set("location.map_zoom",o.value),this.set("encodedLocation",JSON.stringify(this.location))},_mapTypeChanged:function(t,o){o&&o.value&&this.set("location.mapType",o.value),this.set("encodedLocation",JSON.stringify(this.location))},_locationChanged:function(t,o){t&&(this.$.marker.setAttribute("latitude",t.latitude),this.$.marker.setAttribute("longitude",t.longitude),t.map_zoom&&(this.$.map.zoom=t.map_zoom),t.mapType&&(this.$.map.mapType=t.mapType),this.$.map.resize(),this.set("encodedLocation",JSON.stringify(t)))},_setLocation:function(t,o){this.set("location",{latitude:o.latLng.lat(),longitude:o.latLng.lng(),mapType:this.$.map.mapType,map_zoom:this.$.map.zoom})},_groupChanged:function(t){var o;t&&(t.configuration&&t.configuration.defaultLocationLongLat&&""!=t.configuration.defaultLocationLongLat&&t.configuration.defaultLocationLongLat.split(",").length>1?(o=t.configuration.defaultLocationLongLat.trim().split(","),this.set("defaultLongitude",o[0]),this.set("defaultLatitude",o[1])):t.Community&&t.Community.configuration&&t.Community.configuration.defaultLocationLongLat&&""!=t.Community.configuration.defaultLocationLongLat&&t.Community.configuration.defaultLocationLongLat.split(",").length>1&&(o=t.Community.configuration.defaultLocationLongLat.trim().split(","),this.set("defaultLongitude",o[0]),this.set("defaultLatitude",o[1])))},_postChanged:function(t){t||this.set("location",null)}});</script></dom-module><dom-module id="yp-post-edit" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">.access{@apply --layout-horizontal;@apply --layout-center-justified;}paper-button{background-color:var(--accent-color);color:#FFF}yp-file-upload{margin-top:16px}.accessHeader{color:var(--primary-color,#777);font-weight:400;margin-bottom:0}paper-radio-button{display:block}.container{width:100%;width:100%}yp-post-location{min-height:320px}@media (max-width:600px){.container{padding-right:16px}paper-tab{font-size:12px}}section{margin-top:32px}.imageSizeInfo{font-size:12px;padding-bottom:16px;color:#444}paper-dropdown-menu{max-width:250px}.optional{font-size:12px}.icon{padding-right:8px}[hidden]{display:none!important}paper-checkbox{margin-left:8px;margin-top:4px}section{width:100%}.contactInfo{margin-top:16px}#description{--paper-input-container-input:{max-height:125px};}.postEmoji{margin-left:16px}.uploadSection{max-width:300px;margin:8px}.postCoverVideoInfo{margin-top:8px}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog name="postEdit" double-width="" id="editDialog" icon="lightbulb-outline" action="[[action]]" use-next-tab-action="[[newPost]]" on-next-tab-action="_nextTab" method="[[method]]" title="[[editHeaderText]]" save-text="[[saveText]]" class="container" next-action-text="[[t('next')]]" toast-text="[[toastText]]" params="[[params]]"><paper-tabs selected="{{selected}}" id="paperTabs" focused=""><paper-tab><span>[[t('post.yourPost')]]</span></paper-tab><template is="dom-if" restamp="" if="[[newPost]]"><paper-tab><div class="layout vertical center-center"><div>[[t('post.yourPoint')]]</div><div class="optional" hidden$="[[!group.configuration.newPointOptional]]">[[t('optional')]]</div></div></paper-tab></template><template is="dom-if" if="[[!locationHidden]]" restamp=""><paper-tab>[[t('post.location')]]</paper-tab></template><paper-tab>[[t('media')]]</paper-tab></paper-tabs><div class="layout vertical wrap"><iron-pages id="pages" class="layout horizontal" selected="[[selected]]"><section><div class="layout vertical flex"><paper-input id="name" required="" minlength="3" name="name" type="text" label="[[t('title')]]" value="{{post.name}}" maxlength="60" char-counter=""></paper-input><template is="dom-if" if="[[_showCategories(group)]]" restamp=""><paper-dropdown-menu label="[[t('category.select')]]"><paper-listbox slot="dropdown-content" selected="{{selectedCategoryArrayId}}"><template is="dom-repeat" items="[[group.Categories]]" as="category"><paper-item data-category-id$="[[category.id]]">[[category.name]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="categoryId" value="[[selectedCategoryId]]"></template><template is="dom-if" if="[[postDescriptionLimit]]"><paper-textarea id="description" required="" minlength="3" name="description" value="{{post.description}}" always-float-label="[[post.description]]" label="[[t('post.description')]]" char-counter="" rows="2" max-rows="5" maxrows="5" maxlength="[[postDescriptionLimit]]"></paper-textarea><div class="horizontal end-justified layout postEmoji" hidden$="[[group.configuration.hideEmoji]]"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div></template><template is="dom-if" if="[[group.configuration.attachmentsEnabled]]"><yp-file-upload id="attachmentFileUpload" raised="true" multi="false" target="/api/groups/[[group.id]]/upload_document" method="POST" on-success="_documentUploaded"><iron-icon class="icon" icon="attach-file"></iron-icon><span>[[t('uploadAttachment')]]</span></yp-file-upload><template is="dom-if" if="[[post.data.attachment.url]]"><paper-checkbox name="deleteAttachment">[[t('deleteAttachment')]]: [[post.data.attachment.filename]]</paper-checkbox></template></template><template is="dom-if" if="[[group.configuration.moreContactInformation]]"><h2 class="contactInfo">[[t('contactInformation')]]</h2><paper-input id="contactName" name="contactName" type="text" label="[[t('user.name')]]" value="{{post.data.contact.name}}" char-counter=""></paper-input><paper-input id="contactEmail" name="contactEmail" type="text" label="[[t('user.email')]]" value="{{post.data.contact.email}}" char-counter=""></paper-input><paper-input id="contactTelephone" name="contacTelephone" type="text" label="[[t('contactTelephone')]]" value="{{post.data.contact.telephone}}" maxlength="20" char-counter=""></paper-input></template></div></section><template is="dom-if" restamp="" if="[[newPost]]"><section class="subContainer"><paper-textarea id="pointFor" required$="[[!group.configuration.newPointOptional]]" minlength="3" name="pointFor" value="{{post.pointFor}}" always-float-label="[[post.pointFor]]" label="[[t('point.for')]]" char-counter="" rows="2" max-rows="5" maxlength="500"></paper-textarea><div class="horizontal end-justified layout" hidden$="[[group.configuration.hideEmoji]]"><emoji-selector id="emojiSelectorPointFor"></emoji-selector></div></section></template><template is="dom-if" if="[[!locationHidden]]" restamp=""><section><template is="dom-if" if="[[mapActive]]" restamp=""><yp-post-location encoded-location="{{encodedLocation}}" location="{{location}}" group="[[group]]" post="[[post]]"></yp-post-location></template></section></template><section><div class="layout vertical center-center" hidden$="[[hidePostImageUploads]]"><div class="layout horizontal wrap"><div class="layout vertical uploadSection"><yp-file-upload id="imageFileUpload" raised="true" multi="false" target="/api/images?itemType=post-header" method="POST" on-success="_imageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.upload')]]</span></yp-file-upload><div class="imageSizeInfo layout horizontal"><div>864 x 486 (16/9 widescreen)</div></div><div>[[t('post.cover.imageInfo')]]</div></div><template is="dom-if" if="[[group.configuration.allowPostVideoUploads]]"><div class="layout vertical uploadSection"><yp-file-upload id="videoFileUpload" container-type="posts" group="[[group]]" raised="true" multi="false" video-upload="" method="POST" on-success="_videoUploaded"><iron-icon class="icon" icon="videocam"></iron-icon><span>[[t('uploadVideo')]]</span></yp-file-upload><div class="imageSizeInfo layout horizontal"><div>1080p or 720p (16/9 widescreen)</div></div><div>[[t('postCoverVideoInfo')]] <b>[[group.configuration.videoPostUploadLimitSec]] [[t('seconds')]].</b></div></div></template></div><br><h3 class="accessHeader">[[t('post.cover.media')]]</h3><paper-radio-group id="coverMediaType" name="coverMediaType" class="coverMediaType layout horizontal wrap" selected="{{selectedCoverMediaType}}"><paper-radio-button name="none">[[t('post.cover.none')]]</paper-radio-button><paper-radio-button name="image" hidden$="[[!uploadedHeaderImageId]]">[[t('post.cover.image')]]</paper-radio-button><paper-radio-button name="video" hidden$="[[!uploadedVideoId]]">[[t('postCoverVideo')]]</paper-radio-button><template is="dom-if" if="[[location]]"><paper-radio-button name="map">[[t('post.cover.map')]]</paper-radio-button><paper-radio-button name="streetView">[[t('post.cover.streetview')]]</paper-radio-button></template></paper-radio-group></div></section></iron-pages><input type="hidden" name="location" value="[[encodedLocation]]"> <input type="hidden" name="coverMediaType" value="[[selectedCoverMediaType]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"> <input type="hidden" name="uploadedDocumentUrl" value="[[uploadedDocumentUrl]]"> <input type="hidden" name="uploadedDocumentFilename" value="[[uploadedDocumentFilename]]"></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-post-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.ypGotoBehavior],properties:{action:{type:String,value:"/api/posts"},newPost:{type:Boolean,value:!1},post:{type:Object,observer:"_postChanged"},group:{type:Object},locationHidden:{type:Boolean,value:!1,observer:"_locationHiddenChanged"},location:{type:Object,observer:"_locationChanged"},encodedLocation:{type:String,observer:"_encodedLocationChanged"},selectedCategoryArrayId:{type:Number,observer:"_selectedCategoryChanged"},selectedCategoryId:{type:Number},emailValidationPattern:{type:String,value:"^[_A-Za-z0-9-\\+]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$"},selectedCoverMediaType:{type:String,value:"none",observer:"_coverMediaTypeValueChanged"},uploadedHeaderImageId:{type:String,observer:"_uploadedHeaderImageIdChanged"},uploadedVideoId:{type:String,value:null},selected:{type:Number,value:0,observer:"_selectedChanged"},mapActive:{type:Boolean,value:!1},postDescriptionLimit:{type:Number,value:null},uploadedDocumentUrl:String,uploadedDocumentFilename:String},listeners:{"iron-form-invalid":"_formInvalid"},observers:["_setupTranslation(language,t)"],_videoUploaded:function(e,t){this.set("uploadedVideoId",t.videoId),this.set("selectedCoverMediaType","video")},_documentUploaded:function(e,t){var i=JSON.parse(t.xhr.response);this.set("uploadedDocumentUrl",i.url),this.set("uploadedDocumentFilename",i.filename)},customFormResponse:function(){document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-group-posts",data:{id:4}}}))},_updateEmojiBindings:function(){this.async(function(){var e=this.$$("#description"),t=this.$$("#emojiSelectorDescription");e&&t?t.inputTarget=e:console.warn("Post edit: Can't bind emojis :(");var i=this.$$("#emojiSelectorPointFor"),o=this.$$("#pointFor");i&&o&&(i.inputTarget=o)}.bind(this),500)},_locationHiddenChanged:function(e){this.async(function(){var e=this.$$("#pages");e&&e.forceSynchronousItemUpdate();var t=this.$$("#paperTabs");t&&t.forceSynchronousItemUpdate(),console.log("Location hidden changed")},10)},_formInvalid:function(){this.newPost&&this.$$("#name").validate()&&this.$$("#description").validate()?this.set("selected",1):this.set("selected",0),this.$$("#name").autoValidate=!0,this.$$("#description").autoValidate=!0,this.newPost&&(this.$$("#pointFor").autoValidate=!0)},_encodedLocationChanged:function(e){},_locationChanged:function(e){!e||this.selectedCoverMediaType&&""!=this.selectedCoverMediaType&&"none"!=this.selectedCoverMediaType||this.set("selectedCoverMediaType","map")},_uploadedHeaderImageIdChanged:function(e){e&&this.set("selectedCoverMediaType","image")},_nextOnEnter:function(e){13===e.keyCode&&this._searchMap()},_nextTab:function(){var e=3;this.newPost||(e=2),this.locationHidden&&(e-=1),this.selected<e&&this.set("selected",this.selected+1)},_selectedChanged:function(e){this.locationHidden||e!=(this.newPost?2:1)?this.set("mapActive",!1):this.set("mapActive",!0);var t=this.locationHidden?2:3;if(!this.newPost||this.newPost&&e==t?this.$$("#editDialog").useNextTabAction=!1:this.$$("#editDialog").useNextTabAction=!0,0==e){var i=this.$$("#name");i&&i.focus()}if(1==e){var o=this.$$("#pointFor");o&&o.focus()}},_selectedCategoryChanged:function(e,t){null!=e&&void 0!=e&&(this.selectedCategoryId=this.group.Categories[e].id)},_showCategories:function(e){return!(!e||!e.Categories)&&e.Categories.length>0},getPositionInArrayFromId:function(e,t){for(var i=0;i<e.length;i++)if(e[i].id==t)return i;return null},_postChanged:function(e,t){e&&(e.location&&(this.set("location",e.location),this.set("encodedLocation",JSON.stringify(this.location))),e.cover_media_type&&(this.selectedCoverMediaType=e.cover_media_type)),this._updateEmojiBindings()},_updateInitialCategory:function(e){e&&this.post&&this.post.category_id&&(this.selectedCategoryId=this.post.category_id,this.selectedCategoryArrayId=this.getPositionInArrayFromId(e.Categories,this.post.category_id))},_imageUploaded:function(e,t){var i=JSON.parse(t.xhr.response);this.set("uploadedHeaderImageId",i.id)},_coverMediaTypeValueChanged:function(e,t){},_coverMediaTypeChanged:function(e,t){},_customRedirect:function(e){if(e)if(e.newEndorsement&&window.appUser&&window.appUser.endorsementPostsIndex&&(window.appUser.endorsementPostsIndex[e.id]=e.newEndorsement),this.uploadedVideoId){this.post=e;var t=document.createElement("iron-ajax");t.handleAs="json",t.contentType="application/json",t.url="/api/videos/"+this.post.id+"/completeAndAddToPost",t.method="PUT",t.body={videoId:this.uploadedVideoId},t.addEventListener("response",function(t){this._finishRedirect(e)}.bind(this)),t.generateRequest()}else this._finishRedirect(e);else console.warn("No post found on custom redirect")},_finishRedirect:function(e){this.redirectTo("/post/"+(e?e.id:this.post.id)),window.appGlobals.activity("completed","newPost")},_clear:function(){this.newPost&&(this.set("post",{name:"",description:"",pointFor:"",categoryId:null}),this.set("location",null),this.set("selectedCategoryArrayId",null),this.set("selectedCategoryId",null),this.set("selected",0),this.set("uploadedHeaderImageId",null),this.set("uploadedVideoId",null),this.$$("#imageFileUpload").clear(),this.set("selectedCoverMediaType","none"))},setup:function(e,t,i,o){this._setupGroup(o),e?(this.set("post",e),e.PostVideos&&e.PostVideos.length>0&&this.set("uploadedVideoId",e.PostVideos[0].id)):this.set("post",null),this._updateInitialCategory(o),this.set("newPost",t),this.set("refreshFunction",i),this._setupTranslation(),this._clear()},_setupGroup:function(e){e&&(this.set("group",e),e.configuration?(e.configuration.locationHidden&&1==e.configuration.locationHidden?this.set("locationHidden",!0):this.set("locationHidden",!1),e.configuration.postDescriptionLimit?this.set("postDescriptionLimit",e.configuration.postDescriptionLimit):this.set("postDescriptionLimit",500)):this.set("postDescriptionLimit",500))},setupAfterOpen:function(e){this._setupGroup(e.group),this.async(function(){var e=this.$$("#name");e&&e.focus()}.bind(this),250)},_setupTranslation:function(){this.async(function(){this.t&&(this.newPost?(this.editHeaderText=this.t("post.new"),this.toastText=this.t("postCreated"),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.editHeaderText=this.t("post.edit"),this.toastText=this.t("postUpdated")))}.bind(this),20)}});</script><script>Polymer.ypCollectionStatusOptions={properties:{collectionStatusOptions:{type:Object,computed:"_collectionStatusOptions(language)"}},_collectionStatusOptions:function(t){return t?[{name:"active",translatedName:this.t("status.active")},{name:"featured",translatedName:this.t("status.featured")},{name:"archived",translatedName:this.t("status.archived")},{name:"hidden",translatedName:this.t("status.hidden")}]:[]}};</script><dom-module id="yp-community-edit" assetpath="../yp-community/"><template><style include="iron-flex iron-flex-alignment">.access{@apply --layout-horizontal;@apply --layout-center-justified;}.accessHeader{color:var(--primary-color,#777);font-weight:400;margin-bottom:0}paper-radio-button{display:block}.additionalSettings{padding-top:16px}.half{width:50%}.hostnameInfo{color:#888}.config{margin-top:16px}paper-checkbox{margin-bottom:4px}.uploadSection{max-width:300px;margin:8px}.useVideoCover{margin-left:4px;margin-top:4px}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog name="communityEdit" id="editDialog" title="[[editHeaderText]]" icon="group-work" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><div class="layout vertical"><paper-input id="name" name="name" type="text" label="[[t('name')]]" value="{{community.name}}" maxlength="60" minlength="1" required="" char-counter="" class="mainInput"></paper-input><paper-input id="hostname" name="hostname" type="text" allowed-pattern="[a-z0-9-]" label="[[t('community.hostname')]]" value="{{community.hostname}}" maxlength="80" minlength="1" required="" char-counter="" class="mainInput"></paper-input><div class="hostnameInfo">https://[[hostnameExample]]</div><paper-textarea id="description" name="description" value="{{community.description}}" always-float-label="[[community.description]]" label="[[t('description')]]" char-counter="" rows="2" max-rows="5" minlength="1" required="" maxlength="300" class="mainInput"></paper-textarea><div class="horizontal end-justified layout"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div></div><div class="layout horizontal wrap"><div class="layout vertical additionalSettings uploadSection"><yp-file-upload id="logoImageUpload" raised="true" multi="false" target="/api/images?itemType=community-logo" method="POST" on-success="_logoImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings uploadSection"><yp-file-upload id="headerImageUpload" raised="true" multi="false" target="/api/images?itemType=community-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div><template is="dom-if" if="[[hasVideoUpload]]"><div class="layout vertical uploadSection"><yp-file-upload id="videoFileUpload" raised="true" multi="false" video-upload="" method="POST" on-success="_videoUploaded"><iron-icon class="icon" icon="videocam"></iron-icon><span>[[t('uploadVideo')]]</span></yp-file-upload><paper-checkbox class="useVideoCover" name="useVideoCover" disabled$="[[!uploadedVideoId]]" checked$="{{community.configuration.useVideoCover}}">[[t('useVideoCover')]]</paper-checkbox></div></template></div><yp-theme-selector object="[[community]]" selected-theme="{{themeId}}"></yp-theme-selector><div class="layout vertical config"><paper-checkbox name="onlyAdminsCanCreateGroups" checked$="{{community.only_admins_can_create_groups}}">[[t('community.onlyAdminsCanCreateGroups')]]</paper-checkbox><paper-checkbox name="alternativeHeader" checked$="{{community.configuration.alternativeHeader}}">[[t('community.alternativeHeader')]]</paper-checkbox><paper-checkbox name="disableDomainUpLink" checked$="{{community.configuration.disableDomainUpLink}}">[[t('disableCommunityDomainUpLink')]]</paper-checkbox><paper-checkbox name="disableNameAutoTranslation" checked$="{{community.configuration.disableNameAutoTranslation}}">[[t('disableNameAutoTranslation')]]</paper-checkbox></div><input type="hidden" name="themeId" value="[[themeId]]"> <input type="hidden" name="uploadedLogoImageId" value="[[uploadedLogoImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"> <input type="hidden" name="appHomeScreenIconImageId" value="[[appHomeScreenIconImageId]]"><div class="layout horizontal config"><paper-dropdown-menu label="[[t('status.select')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{status}}"><template is="dom-repeat" items="[[collectionStatusOptions]]" as="statusOption"><paper-item name="[[statusOption.name]]">[[statusOption.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="status" value="[[status]]"></div><yp-language-selector name="defaultLocale" no-user-events="" selected-locale="{{community.default_locale}}"></yp-language-selector><div class="layout horizontal config" hidden$="[[!pages]]"><paper-dropdown-menu label="[[t('signupTermsSelectPage')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{community.configuration.signupTermsPageId}}"><template is="dom-repeat" items="[[translatedPages]]" as="page"><paper-item name="[[page.id]]" data-args$="[[index]]">[[_getLocalizePageTitle(page)]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="signupTermsPageId" value="[[community.configuration.signupTermsPageId]]"></div><paper-input id="google_analytics_code" name="google_analytics_code" type="text" label="[[t('analyticsTrackerCode')]]" value="{{community.google_analytics_code}}" maxlength="40" style="width:200px"></paper-input><paper-input id="facebookPixelId" name="facebookPixelId" type="text" label="[[t('facebookPixelId')]]" value="{{community.configuration.facebookPixelId}}" maxlength="40" style="width:200px"></paper-input><paper-input id="defaultLocationLongLat" name="defaultLocationLongLat" type="text" label="[[t('defaultLocationLongLat')]]" value="{{community.defaultLocationLongLat}}" maxlength="100" style="width:300px"></paper-input><h3 class="accessHeader">[[t('access')]]</h3><paper-radio-group id="access" name="access" class="access" selected="{{communityAccess}}"><paper-radio-button name="public">[[t('public')]]</paper-radio-button><paper-radio-button name="closed">[[t('closed')]]</paper-radio-button><paper-radio-button name="secret">[[t('secret')]]</paper-radio-button></paper-radio-group><paper-textarea id="welcomeHTML" name="welcomeHTML" value="{{community.configuration.welcomeHTML}}" always-float-label="[[community.configuration.welcomeHTML]]" label="[[t('welcomeHTML')]]" rows="2" max-rows="5" minlength="1" class="mainInput"></paper-textarea><paper-input id="appHomeScreenShortName" name="appHomeScreenShortName" type="text" label="[[t('appHomeScreenShortName')]]" value="{{community.configuration.appHomeScreenShortName}}" maxlength="12" style="width:200px"></paper-input><div class="layout vertical additionalSettings half"><yp-file-upload id="appHomeScreenIconImageUpload" raised="true" multi="false" target="/api/images?itemType=app-home-screen-icon" method="POST" on-success="_appHomeScreenIconImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('appHomeScreenIconImageUpload')]] (512x512)</span></yp-file-upload></div><yp-ajax id="pagesAjax" on-response="_pagesResponse"></yp-ajax></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-community-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.ypCollectionStatusOptions,Polymer.ypGotoBehavior,Polymer.ypTranslatedPagesBehavior],properties:{action:{type:String,value:"/api/communities"},community:{type:Object,observer:"_communityChanged"},hostnameExample:{type:String,computed:"_getExampleHostname(community.hostname)"},communityAccess:{type:String,value:"public"},params:{type:String},method:{type:String},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String},uploadedAppIconImageId:{type:String},status:String,themeId:{type:String,value:null},appHomeScreenIconImageId:String,hasVideoUpload:{type:Boolean,value:!1},uploadedVideoId:{type:Number,value:null}},observers:["_setupTranslation(language,t)"],_videoUploaded:function(e,t){this.set("uploadedVideoId",t.videoId)},_pagesResponse:function(e,t){var i=t.response;i.unshift({id:-1,title:{en:this.t("none")}}),this._setPages(e,i)},_appHomeScreenIconImageUploaded:function(e,t){var i=JSON.parse(t.xhr.response);this.set("appHomeScreenIconImageId",i.id)},_updateEmojiBindings:function(){this.async(function(){var e=this.$$("#description"),t=this.$$("#emojiSelectorDescription");e&&t?t.inputTarget=e:console.warn("Community edit: Can't bind emojis :(")}.bind(this),500)},_getExampleHostname:function(e){return e?e+"."+window.appGlobals.domain.domain_name:"your-hostname."+window.appGlobals.domain.domain_name},_customRedirect:function(e){if(e&&e.hostnameTaken)Polymer.dom(document).querySelector("yp-app").getDialogAsync("errorDialog",function(e){e.showErrorDialog(this.t("hostnameTaken"))}.bind(this));else if(e)if(window.appUser.recheckAdminRights(),this.uploadedVideoId){var t=document.createElement("iron-ajax");t.handleAs="json",t.contentType="application/json",t.url="/api/videos/"+e.id+"/completeAndAddToCommunity",t.method="PUT",t.body={videoId:this.uploadedVideoId},t.addEventListener("response",function(t){this._finishRedirect(e)}.bind(this)),t.generateRequest()}else this._finishRedirect(e);else console.warn("No community found on custom redirect")},_finishRedirect:function(e){this.redirectTo("/community/"+e.id),window.appGlobals.activity("completed","editCommunity")},_communityChanged:function(e,t){e&&(0===this.community.access?this.communityAccess="public":1===this.community.access?this.communityAccess="closed":2===this.community.access&&(this.communityAccess="secret"),this.community.status&&this.set("status",this.community.status)),this._updateEmojiBindings(),window.appGlobals.hasVideoUpload?this.set("hasVideoUpload",!0):this.set("hasVideoUpload",!1)},_clear:function(){this.set("community",null),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.set("appHomeScreenIconImageId",null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear(),this.$.appHomeScreenIconImageUpload.clear(),this.$$("#videoFileUpload")&&this.$$("#videoFileUpload").clear()},setup:function(e,t,i){e?(this.set("community",e),e.CommunityLogoVideos&&e.CommunityLogoVideos.length>0&&this.set("uploadedVideoId",e.CommunityLogoVideos[0].id),this.$.pagesAjax.url="/api/communities/"+e.id+"/pages",this.$.pagesAjax.generateRequest()):this.set("community",{name:"",description:"",access:0,status:"active"}),this.set("new",t),this.set("refreshFunction",i),this._setupTranslation()},_setupTranslation:function(){this.t&&(this.new?(this.set("editHeaderText",this.t("community.new")),this.set("toastText",this.t("communityToastCreated")),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.set("editHeaderText",this.t("Update community info")),this.set("toastText",this.t("communityToastUpdated"))))}});</script><dom-module id="yp-group-edit" assetpath="../yp-group/"><template><style include="iron-flex iron-flex-alignment">.access{@apply --layout-horizontal;@apply --layout-center-justified;}.accessHeader{color:var(--primary-color,#777);font-weight:400;margin-bottom:0}paper-radio-button{display:block}.additionalSettings{padding-top:8px}.half{width:50%}.config{padding:8px;vertical-align:top}paper-checkbox{padding-top:8px}.icon{padding-right:8px}paper-dropdown-menu{max-width:250px;width:250px}.categoryName{padding-left:8px}[hidden]{display:none!important}.uploadSection{max-width:300px;margin:8px}.useVideoCover{margin-left:4px;margin-top:4px}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog name="groupEdit" id="editDialog" title="[[editHeaderText]]" icon="people" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><paper-input id="name" name="name" type="text" label="[[t('name')]]" value="{{group.name}}" maxlength="50" char-counter=""></paper-input><paper-textarea id="objectives" name="objectives" value="{{group.objectives}}" always-float-label="[[group.objectives]]" label="[[t('group.objectives')]]" char-counter="" rows="2" max-rows="5" maxlength="300"></paper-textarea><div class="horizontal end-justified layout"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div><div class="layout horizontal wrap"><div class="layout vertical additionalSettings uploadSection"><yp-file-upload id="logoImageUpload" raised="true" multi="false" target="/api/images?itemType=group-logo" method="POST" on-success="_logoImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings uploadSection"><yp-file-upload id="headerImageUpload" raised="true" multi="false" target="/api/images?itemType=group-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div><template is="dom-if" if="[[hasVideoUpload]]"><div class="layout vertical uploadSection"><yp-file-upload id="videoFileUpload" raised="true" multi="false" video-upload="" method="POST" on-success="_videoUploaded"><iron-icon class="icon" icon="videocam"></iron-icon><span>[[t('uploadVideo')]]</span></yp-file-upload><paper-checkbox class="useVideoCover" name="useVideoCover" disabled$="[[!uploadedVideoId]]" checked$="{{group.configuration.useVideoCover}}">[[t('useVideoCover')]]</paper-checkbox></div></template><input type="hidden" name="uploadedLogoImageId" value="[[uploadedLogoImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"></div><div class="layout vertical"><div class="layout vertical config"><yp-theme-selector object="[[group]]" selected-theme="{{themeId}}"></yp-theme-selector><div class="layout vertical"><paper-dropdown-menu label="[[t('status.select')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{status}}"><template is="dom-repeat" items="[[collectionStatusOptions]]" as="statusOption"><paper-item name="[[statusOption.name]]">[[statusOption.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="status" value="[[status]]"><div class="layout horizontal"><paper-dropdown-menu label="[[t('endorsementButtons')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{endorsementButtons}}"><template is="dom-repeat" items="[[endorsementButtonsOptions]]" as="buttonsSelection"><paper-item name="[[buttonsSelection.name]]">[[buttonsSelection.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="endorsementButtons" value="[[endorsementButtons]]"></div></div></div><div class="layout vertical config"><paper-checkbox name="canVote" checked$="{{canVote}}">[[t('group.canVote')]]</paper-checkbox><paper-checkbox name="canAddNewPosts" checked$="{{canAddNewPosts}}">[[t('group.canAddNewPosts')]]</paper-checkbox><paper-checkbox name="disableDebate" checked$="{{group.configuration.disableDebate}}">[[t('disableDebate')]]</paper-checkbox><paper-checkbox name="locationHidden" checked$="{{locationHidden}}">[[t('group.locationHidden')]]</paper-checkbox><paper-checkbox name="showWhoPostedPosts" checked$="{{showWhoPostedPosts}}">[[t('group.showWhoPostedPosts')]]</paper-checkbox><paper-checkbox name="allowPostVideoUploads" disabled$="[[!hasVideoUpload]]" checked$="{{allowPostVideoUploads}}">[[t('allowPostVideoUploads')]]</paper-checkbox><paper-checkbox name="allowPointVideoUploads" disabled$="[[!hasVideoUpload]]" checked$="{{allowPointVideoUploads}}">[[t('allowPointVideoUploads')]]</paper-checkbox></div></div><input type="hidden" name="canVote" value$="[[canVote]]"> <input type="hidden" name="canAddNewPosts" value$="[[canAddNewPosts]]"> <input type="hidden" name="locationHidden" value$="[[locationHidden]]"> <input type="hidden" name="showWhoPostedPosts" value$="[[showWhoPostedPosts]]"> <input type="hidden" name="themeId" value="[[themeId]]"><yp-language-selector name="defaultLocale" no-user-events="" selected-locale="{{group.configuration.defaultLocale}}"></yp-language-selector><h3 class="accessHeader">[[t('access')]]</h3><paper-radio-group id="access" name="access" class="access" selected="{{groupAccess}}"><paper-radio-button name="public" hidden$="[[!publicCommunity]]">[[t('group.public')]]</paper-radio-button><paper-radio-button name="open_to_community" hidden$="[[publicCommunity]]">[[t('group.openToCommunity')]]</paper-radio-button><paper-radio-button name="closed">[[t('group.closed')]]</paper-radio-button><paper-radio-button name="secret">[[t('group.secret')]]</paper-radio-button></paper-radio-group><hr><div class="layout horizontal"><div class="layout vertical additionalSettings"><yp-file-upload id="defaultPostImageUpload" raised="true" multi="false" target="/api/images?itemType=group-logo" method="POST" on-success="_defaultPostImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('defaultPostImage')]]</span></yp-file-upload></div><input type="hidden" name="uploadedDefaultPostImageId" value="[[uploadedDefaultPostImageId]]"></div><paper-input id="videoPostUploadLimitSec" name="videoPostUploadLimitSec" allowed-pattern="[0-9]" maxlength="3" type="number" disabled$="[[!hasVideoUpload]]" label="[[t('videoPostUploadLimitSec')]]" value="{{group.configuration.videoPostUploadLimitSec}}"></paper-input><paper-input id="videoPointUploadLimitSec" name="videoPointUploadLimitSec" type="text" maxlength="3" allowed-pattern="[0-9]" disabled$="[[!hasVideoUpload]]" label="[[t('videoPointUploadLimitSec')]]" value="{{group.configuration.videoPointUploadLimitSec}}"></paper-input><div class="layout vertical config"><h2>[[t('additionalGroupConfig')]]</h2><paper-checkbox name="attachmentsEnabled" checked$="{{group.configuration.attachmentsEnabled}}">[[t('attachmentsEnabled')]]</paper-checkbox><paper-checkbox name="moreContactInformation" checked$="{{group.configuration.moreContactInformation}}">[[t('moreContactInformation')]]</paper-checkbox><paper-checkbox name="hideAllTabs" checked$="{{hideAllTabs}}">[[t('hideAllTabs')]]</paper-checkbox><paper-checkbox name="hideNewPostOnPostPage" checked$="{{hideNewPostOnPostPage}}">[[t('hideNewPostOnPostPage')]]</paper-checkbox><paper-checkbox name="newPointOptional" checked$="{{newPointOptional}}">[[t('newPointOptional')]]</paper-checkbox><paper-checkbox name="hideHelpIcon" checked$="{{hideHelpIcon}}">[[t('hideHelpIcon')]]</paper-checkbox><paper-checkbox name="hideEmoji" checked$="{{hideEmoji}}">[[t('hideEmoji')]]</paper-checkbox><paper-checkbox name="hideGroupHeader" checked$="{{hideGroupHeader}}">[[t('hideGroupHeader')]]</paper-checkbox><paper-checkbox name="hidePointAuthor" checked$="{{group.configuration.hidePointAuthor}}">[[t('hidePointAuthor')]]</paper-checkbox><paper-checkbox name="hideDownVoteForPost" checked$="{{group.configuration.hideDownVoteForPost}}">[[t('hideDownVoteForPost')]]</paper-checkbox><paper-checkbox name="hidePostAuthor" checked$="{{group.configuration.hidePostAuthor}}">[[t('hidePostAuthor')]]</paper-checkbox><paper-checkbox name="allowAnonymousUsers" checked$="{{group.configuration.allowAnonymousUsers}}">[[t('allowAnonymousUsers')]]</paper-checkbox><paper-checkbox name="allowAnonymousAutoLogin" checked$="{{group.configuration.allowAnonymousAutoLogin}}">[[t('allowAnonymousAutoLogin')]]</paper-checkbox><paper-checkbox name="disableFacebookLoginForGroup" checked$="{{group.configuration.disableFacebookLoginForGroup}}">[[t('disableFacebookLoginForGroup')]]</paper-checkbox><paper-checkbox name="disableNameAutoTranslation" checked$="{{group.configuration.disableNameAutoTranslation}}">[[t('disableNameAutoTranslation')]]</paper-checkbox><paper-checkbox name="hideNewPost" checked$="{{group.configuration.hideNewPost}}">[[t('hideNewPost')]]</paper-checkbox><paper-checkbox name="hideVoteCount" checked$="{{group.configuration.hideVoteCount}}">[[t('hideVoteCount')]]</paper-checkbox><paper-checkbox name="hideVoteCountUntilVoteCompleted" checked$="{{group.configuration.hideVoteCountUntilVoteCompleted}}">[[t('hideVoteCountUntilVoteCompleted')]]</paper-checkbox><paper-checkbox name="hidePostCover" checked$="{{group.configuration.hidePostCover}}">[[t('hidePostCover')]]</paper-checkbox><paper-checkbox name="hidePostDescription" checked$="{{group.configuration.hidePostDescription}}">[[t('hidePostDescription')]]</paper-checkbox><paper-checkbox name="hidePostActionsInGrid" checked$="{{group.configuration.hidePostActionsInGrid}}">[[t('hidePostActionsInGrid')]]</paper-checkbox><paper-checkbox name="hideDebateIcon" checked$="{{group.configuration.hideDebateIcon}}">[[t('hideDebateIcon')]]</paper-checkbox><paper-checkbox name="disablePostPageLink" checked$="{{group.configuration.disablePostPageLink}}">[[t('disablePostPageLink')]]</paper-checkbox><paper-checkbox name="forceSecureSamlLogin" disabled$="[[!hasSamlLoginProvider]]" checked$="{{group.configuration.forceSecureSamlLogin}}">[[t('forceSecureSamlLogin')]]</paper-checkbox><paper-checkbox name="hidePostFilterAndSearch" checked$="{{group.configuration.hidePostFilterAndSearch}}">[[t('hidePostFilterAndSearch')]]</paper-checkbox><paper-checkbox name="hidePostImageUploads" disabled$="[[!hasVideoUpload]]" checked$="{{group.configuration.hidePostImageUploads}}">[[t('hidePostImageUploads')]]</paper-checkbox></div><paper-input id="defaultLocationLongLat" name="defaultLocationLongLat" type="text" label="[[t('defaultLocationLongLat')]]" value="{{group.defaultLocationLongLat}}" maxlength="100" style="width:300px"></paper-input><input type="hidden" name="hideAllTabs" value$="[[hideAllTabs]]"> <input type="hidden" name="hideNewPostOnPostPage" value$="[[hideNewPostOnPostPage]]"> <input type="hidden" name="newPointOptional" value$="[[newPointOptional]]"> <input type="hidden" name="hideHelpIcon" value$="[[hideHelpIcon]]"> <input type="hidden" name="hideEmoji" value$="[[hideEmoji]]"> <input type="hidden" name="hideGroupHeader" value$="[[hideGroupHeader]]"> <input type="hidden" name="allowPostVideoUploads" value$="[[allowPostVideoUploads]]"> <input type="hidden" name="allowPointVideoUploads" value$="[[allowPointVideoUploads]]"><paper-input id="alternativePointForHeader" name="alternativePointForHeader" type="text" label="[[t('alternativePointForHeader')]]" value="{{group.configuration.alternativePointForHeader}}" maxlength="100" char-counter=""></paper-input><paper-input id="alternativePointAgainstHeader" name="alternativePointAgainstHeader" type="text" label="[[t('alternativePointAgainstHeader')]]" value="{{group.configuration.alternativePointAgainstHeader}}" maxlength="100" char-counter=""></paper-input><paper-input id="alternativePointForLabel" name="alternativePointForLabel" type="text" label="[[t('alternativePointForLabel')]]" value="{{group.configuration.alternativePointForLabel}}" maxlength="100" char-counter=""></paper-input><paper-input id="alternativePointAgainstLabel" name="alternativePointAgainstLabel" type="text" label="[[t('alternativePointAgainstLabel')]]" value="{{group.configuration.alternativePointAgainstLabel}}" maxlength="100" char-counter=""></paper-input><paper-input id="postDescriptionLimit" name="postDescriptionLimit" type="text" label="[[t('postDescriptionLimit')]]" value="{{group.configuration.postDescriptionLimit}}" maxlength="4" char-counter=""></paper-input><paper-input id="externalGoalTriggerUrl" name="externalGoalTriggerUrl" type="text" label="[[t('externalGoalTriggerUrl')]]" value="{{group.configuration.externalGoalTriggerUrl}}"></paper-input><div class="layout horizontal"><div class="layout vertical additionalSettings"><yp-file-upload id="defaultDataImageUpload" raised="true" multi="false" target="/api/images?itemType=group-logo" method="POST" on-success="_defaultDataImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('defaultDataImage')]]</span></yp-file-upload></div><input type="hidden" name="uploadedDefaultDataImageId" value="[[uploadedDefaultDataImageId]]"></div><div class="layout vertical config" hidden$="[[!group.Categories]]"><h2>[[t('categories.the_all')]]</h2><template is="dom-repeat" items="[[group.Categories]]" as="category"><paper-item data-category$="[[category]]" data-category-name$="[[category.name]]" on-tap="_openCategoryEdit"><img sizing="cover" height="24" width="24" class="filterIcon" src="[[_categoryImageSrc(category)]]"> <span class="categoryName">[[category.name]]</span></paper-item></template></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-group-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.ypCollectionStatusOptions,Polymer.ypGotoBehavior,Polymer.ypImageFormatsBehavior],properties:{canVote:{type:Boolean,value:!0},canAddNewPosts:{type:Boolean,value:!0},showWhoPostedPosts:{type:Boolean,value:!1},hideAllTabs:Boolean,hideNewPostOnPostPage:Boolean,newPointOptional:Boolean,hideHelpIcon:Boolean,hideEmoji:Boolean,hideGroupHeader:Boolean,action:{type:String,value:"/api/groups"},group:{type:Object,observer:"_groupChanged"},community:{type:Object},groupAccess:{type:String,value:"public"},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String},uploadedDefaultDataImageId:{type:String},uploadedDefaultPostImageId:{type:String},allowPostVideoUploads:{type:Boolean,value:null},allowPointVideoUploads:{type:Boolean,value:null},status:String,publicCommunity:{type:Boolean,value:!1},themeId:{type:String,value:null},locationHidden:Boolean,endorsementButtonsOptions:{type:Object,computed:"_endorsementButtonsOptions(language)"},endorsementButtons:String,hasSamlLoginProvider:{type:Boolean,value:!1},hasVideoUpload:{type:Boolean,value:!1},uploadedVideoId:{type:Number,value:null}},_videoUploaded:function(t,o){this.set("uploadedVideoId",o.videoId)},observers:["_setupTranslation(language,t)"],_openCategoryEdit:function(t){window.appGlobals.activity("open","category.new"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("categoryEdit",function(o){o.setup(this.group,!1,this._refreshCategories.bind(this),t.model.category),o.open("edit",{categoryId:t.model.category.id})}.bind(this))},_refreshCategories:function(t){var o=[];__.each(this.group.Categories,function(e){e.id===t.id?o.push(t):o.push(e)}),this.set("group.Categories",o)},_categoryImageSrc:function(t){return this.getImageFormatUrl(t.CategoryIconImages,0)},_endorsementButtonsOptions:function(t){return this.t?[{name:"hearts",translatedName:this.t("endorsementButtonsHeart")},{name:"arrows",translatedName:this.t("endorsementArrows")},{name:"thumbs",translatedName:this.t("endorsementThumbs")},{name:"hats",translatedName:this.t("endorsementHats")}]:[]},_updateEmojiBindings:function(){this.async(function(){var t=this.$$("#objectives"),o=this.$$("#emojiSelectorDescription");t&&o?o.inputTarget=t:console.warn("Group edit: Can't bind emojis :(")}.bind(this),500)},_publicCommunity:function(t){return!!t&&0===t.Community.access},_customRedirect:function(t){if(t)if(window.appUser.recheckAdminRights(),this.uploadedVideoId){var o=document.createElement("iron-ajax");o.handleAs="json",o.contentType="application/json",o.url="/api/videos/"+t.id+"/completeAndAddToGroup",o.method="PUT",o.body={videoId:this.uploadedVideoId},o.addEventListener("response",function(o){this._finishRedirect(t)}.bind(this)),o.generateRequest()}else this._finishRedirect(t);else console.warn("No group found on custom redirect")},_finishRedirect:function(t){this.redirectTo("/group/"+t.id),window.appGlobals.activity("completed","editGroup")},_groupChanged:function(t,o){this.group&&(0==this.group.access?this.groupAccess="public":1==this.group.access?this.groupAccess="closed":2==this.group.access?this.groupAccess="secret":3==this.group.access&&(this.groupAccess="open_to_community"),this.group&&this.group.status&&this.set("status",this.group.status),this.group.configuration&&void 0!=this.group.configuration.canVote?(this.set("canVote",this.group.configuration.canVote),this.set("canAddNewPosts",this.group.configuration.canAddNewPosts)):(this.set("canVote",!0),this.set("canAddNewPosts",!0)),this.group.configuration&&void 0!=this.group.configuration.endorsementButtons?this.set("endorsementButtons",this.group.configuration.endorsementButtons):this.set("endorsementButtons","hearts"),this._setFromConfiguration("locationHidden"),this._setFromConfiguration("hideAllTabs"),this._setFromConfiguration("hideNewPostOnPostPage"),this._setFromConfiguration("newPointOptional"),this._setFromConfiguration("hideHelpIcon"),this._setFromConfiguration("hideEmoji"),this._setFromConfiguration("hideGroupHeader"),this._setFromConfiguration("showWhoPostedPosts"),this._setFromConfiguration("allowPostVideoUploads",!0),this._setFromConfiguration("allowPointVideoUploads",!0),this.async(function(){this.community?0==this.community.access?this.set("publicCommunity",!0):this.set("publicCommunity",!1):this.group&&this.group.Community&&(0==this.group.Community.access?this.set("publicCommunity",!0):this.set("publicCommunity",!1))}),this.group&&this.group.id||!window.appGlobals.hasVideoUpload||(null===this.allowPostVideoUploads&&this.set("allowPostVideoUploads",!0),null===this.allowPointVideoUploads&&this.set("allowPointVideoUploads",!0)),window.appGlobals.hasVideoUpload?this.set("hasVideoUpload",!0):this.set("hasVideoUpload",!1)),this._updateEmojiBindings(),window.appGlobals.domain&&window.appGlobals.domain.samlLoginProvided?this.set("hasSamlLoginProvider",!0):this.set("hasSamlLoginProvider",!1)},_setFromConfiguration:function(t,o){this.group.configuration&&void 0!=this.group.configuration[t]&&""!==this.group.configuration[t]?this.set(t,this.group.configuration[t]):this.set(t,!!o&&null)},_clear:function(){this.set("group",null),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.set("uploadedDefaultDataImageId",null),this.set("uploadedVideoId",null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear(),this.$.defaultDataImageUpload.clear(),this.$$("#videoFileUpload")&&this.$$("#videoFileUpload").clear()},setup:function(t,o,e){t?(this.set("group",t),t.GroupLogoVideos&&t.GroupLogoVideos.length>0&&this.set("uploadedVideoId",t.GroupLogoVideos[0].id)):this.set("group",{name:"",objectives:"",access:0,status:"active"}),this.set("new",o),this.set("refreshFunction",e),this._setupTranslation()},setupAfterOpen:function(t){t.community&&(this.community=t.community);var o=0;this.community?0!=this.community.access&&(this.set("groupAccess","open_to_community"),this.set("group.access",3),o=3):this.group.Community&&0!=this.group.Community.access&&(this.set("groupAccess","open_to_community"),o=3),this.set("group.access",o)},_setupTranslation:function(t,o){this.language&&this.t&&(this.new?(this.editHeaderText=this.t("group.new"),this.toastText=this.t("groupToastCreated"),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.editHeaderText=this.t("group.update"),this.toastText=this.t("groupToastUpdated")))}});</script><dom-module id="yp-magic-text-dialog" assetpath="../yp-magic-text/"><template><style>:host{display:block}#dialog{background-color:#FFF}@media (max-width:600px){paper-dialog{padding:0;margin:0}}.buttons{color:var(--accent-color)}</style><paper-dialog id="dialog"><h2>[[pageTitle]]</h2><paper-dialog-scrollable><div hidden$="[[!finalContent]]" inner-h-t-m-l="[[finalContent]]"></div><div hidden$="[[finalContent]]">[[content]]</div></paper-dialog-scrollable><div class="buttons"><paper-button raised="" on-tap="_close" dialog-dismiss="">[[closeDialogText]]</paper-button></div></paper-dialog><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-yp-auto-translate="_autoTranslateEvent"></lite-signal><iron-ajax id="getTranslationAjax" on-response="_getTranslationResponse"></iron-ajax></template><script>var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var YpMagicTextBoxDialog=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,YpMagicTextBox),_createClass(t,[{key:"subClassProcessing",value:function(){this.processedContent=this.processedContent.replace(/\n/g,"<br />")}},{key:"open",value:function(e,t,n,o,r,i){this.contentId=t,this.extraId=n,this.textType=o,this.contentLanguage=r,this.set("content",e),this.set("closeDialogText",i),this.$.dialog.open()}}],[{key:"is",get:function(){return"yp-magic-text-dialog"}}]),t}();customElements.define(YpMagicTextBoxDialog.is,YpMagicTextBoxDialog);</script></dom-module><dom-module id="yp-post-user-image-edit" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment"></style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog double-width="" id="editDialog" icon="photo-camera" action="[[action]]" title="[[editHeaderText]]" method="[[method]]" save-text="[[saveText]]" next-action-text="[[t('next')]]" toast-text="[[toastText]]" params="[[params]]"><div class="layout vertical center-center"><yp-file-upload id="imageFileUpload" raised="true" multi="false" method="POST" on-success="_imageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.upload')]]</span></yp-file-upload></div><paper-input id="photographerName" name="photographerName" type="text" label="[[t('post.photographerName')]]" value="{{image.photographer_name}}" maxlength="60" char-counter=""></paper-input><paper-textarea id="description" required="" minlength="1" name="description" value="{{image.description}}" always-float-label="[[image.description]]" label="[[t('post.description')]]" char-counter="" rows="2" max-rows="5" maxlength="200"></paper-textarea><input type="hidden" name="uploadedPostUserImageId" value="[[uploadedPostUserImageId]]"> <input type="hidden" name="oldUploadedPostUserImageId" value="[[oldUploadedPostUserImageId]]"></yp-edit-dialog></template><script>Polymer({is:"yp-post-user-image-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior],properties:{new:{type:Boolean,value:!1},image:{type:Object,observer:"_imageChanged"},post:{type:Object,observer:"_postChange"},action:{type:String,value:"/api/images"},imageUploadTarget:{type:String,notify:!0},uploadedPostUserImageId:{type:String},oldUploadedPostUserImageId:{type:String},editHeaderText:{type:String},saveText:{type:String},method:{type:String}},_postChange:function(t){t&&(this.$.imageFileUpload.target="/api/images?itemType=post-user-image&postId="+t.id)},listeners:{"iron-form-invalid":"_formInvalid"},_imageChanged:function(t){t&&this.set("oldUploadedPostUserImageId",t.id)},_formInvalid:function(){this.set("selected",0),this.$$("#photographerName").autoValidate=!0,this.$$("#description").autoValidate=!0},_imageUploaded:function(t,e){var i=JSON.parse(e.xhr.response);this.set("uploadedPostUserImageId",i.id)},_clear:function(){this.set("uploadedPostUserImageId",null),this.$$("#imageFileUpload").clear()},setup:function(t,e,i,s){e?this.set("image",e):this.set("image",{description:"",photographerName:""}),t?this.set("post",t):this.set("post",null),this.set("new",i),this.set("refreshFunction",s),this._setupTranslation()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t("post.newPhoto"),this.toastText=this.t("post.photo.toast.added")):(this.editHeaderText=this.t("post.photoUpdate"),this.toastText=this.t("post.photo.toast.updated"))}});</script></dom-module></div>